<%
	qs = 12   # quarter size in px
	base = 24 # position of 00:00
	# elasped quarters in the day * qs
	elapsed = (((Time.now - Date.today.to_time) / (60 * 15)) * qs).floor
	# todo: show night/day, need latitude
%>



<div class="hybrid-input">
	<!--<%= datetime_select 'obj', 'start_time', :default => @def_startdate %> (start)<br />
	<%= datetime_select 'obj', 'end_time', :default => @def_enddate %> (end)-->
	<input type="hidden" name="timerange_start" value="" />
	<input type="hidden" name="timerange_end" value="" />
	<div class="mj-timeline-input">
		<button class="slide-before" type="button" disabled="disabled">◀</button>
		<div class="view-container">
			<div class="day-title">
				<div class="view-area"></div>
				<div class="labels">
				<%
					0.upto 7 do |d|
						day = Date.today + d.days
				%>
					<span><%= (d == 0)? "Today" : day.strftime("%a") %></span>
				<%
					end
				%>
				</div>
			</div>
			<div class="timeline-container">
				<%
					now = Time.now
					t = Time.local(now.year, now.month, now.day)
					#t.strftime("%i%p");
				%>
				<div class="timeline-bar"></div>
				<div class="timeline-marks">
					<%
						0.upto 24 * 8 do
					%>
					<div class="mark">
						<div class="line-hour"></div>
						<div class="title-hour"><%= t.strftime("%l%p").downcase %></div>
						<div class="line-quarter"></div>
						<div class="line-half"></div>
						<div class="line-3rd-quarter"></div>
					</div>	
					<%
							t += 1.hours
						end
					%>
				</div>
				<%
					if (show_activities) then
				%>
				<div class="activities">
					<div class="activity" style="margin-left: 15px">●</div>
					<div class="activity" style="margin-left: 50px">●</div>
					<div class="activity" style="margin-left: 105px">●</div>
					<div class="activity scoped date-6" style="margin-left: 155px">●</div>
					<div class="activity scoped date-7" style="margin-left: 165px">●</div>
					<div class="activity scoped date-8" style="margin-left: 210px">●</div>
					<div class="activity" style="margin-left: 255px">●</div>
					<div class="activity" style="margin-left: 265px">●</div>
					<div class="activity" style="margin-left: 385px">●</div>
					<div class="activity" style="margin-left: 400px">●</div>
					<div class="activity" style="margin-left: 415px">●</div>
					<div class="activity" style="margin-left: 450px">●</div>
					<div class="activity" style="margin-left: 470px">●</div>
					<div class="activity" style="margin-left: 500px">●</div>
				</div>
				<%
					end
				%>
				<div class="elapsed-and-current-time" style="width: <%= elapsed %>px;"></div>
				<div class="selected-time" tabindex="0" style="left: <%= base + qs * 4 * 15 %>px; width: <%= qs * 4 * 3 %>px;">
					<div class="start-hand" tabindex="0"></div>
					<div class="stop-hand" tabindex="0"></div>
				</div>
			</div>
		</div>
		<button class="slide-after" type="button">▶</button>
	</div>
</div>
